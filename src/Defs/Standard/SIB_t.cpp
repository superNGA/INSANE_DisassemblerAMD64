//=========================================================================
//                      SIB
//=========================================================================
// by      : INSANE
// created : 15/01/2026
//
// purpose : SIB
//-------------------------------------------------------------------------
#include "../../../Include/Standard/SIB_t.h"
#include "../../Math/SafeBitWiseOps.h"
#include "../../../Include/Rules.h"


using namespace InsaneDASM64;



///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////
void InsaneDASM64::Standard::SIB_t::Store(Byte SIB) 
{ 
    m_SIB = SIB; 
}


///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////
Byte InsaneDASM64::Standard::SIB_t::Get() const 
{ 
    return m_SIB; 
}


///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////
uint64_t InsaneDASM64::Standard::SIB_t::ScaleValueAbs() const
{
    return Maths::SafeAnd(m_SIB, Masks::SIB_SCALE) >> 6;
}


///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////
uint64_t InsaneDASM64::Standard::SIB_t::IndexValueAbs() const
{
    return Maths::SafeAnd(m_SIB, Masks::SIB_INDEX) >> 3;
}


///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////
uint64_t InsaneDASM64::Standard::SIB_t::BaseValueAbs() const
{
    return Maths::SafeAnd(m_SIB, Masks::SIB_BASE);
}

