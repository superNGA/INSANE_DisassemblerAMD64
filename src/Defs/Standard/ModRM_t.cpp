//=========================================================================
//                      ModRM
//=========================================================================
// by      : INSANE
// created : 15/01/2026
//
// purpose : ModRM.
//-------------------------------------------------------------------------
#include "../../../Include/Standard/ModRM_t.h"
#include "../../Math/SafeBitWiseOps.h"
#include "../../../Include/Rules.h"


using namespace InsaneDASM64;


///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////
void InsaneDASM64::Standard::ModRM_t::Store(Byte modrm)
{
    m_modrm = modrm;
}


///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////
Byte InsaneDASM64::Standard::ModRM_t::Get() const
{
    return m_modrm;
}


///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////
uint64_t InsaneDASM64::Standard::ModRM_t::ModValueAbs() const
{
    return Maths::SafeAnd(m_modrm, Masks::MODRM_MOD) >> 6;
}


///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////
uint64_t InsaneDASM64::Standard::ModRM_t::RegValueAbs() const
{
    return Maths::SafeAnd(m_modrm, Masks::MODRM_REG) >> 3;
}


///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////
uint64_t InsaneDASM64::Standard::ModRM_t::RMValueAbs() const
{
    return Maths::SafeAnd(m_modrm, Masks::MODRM_RM);
}
